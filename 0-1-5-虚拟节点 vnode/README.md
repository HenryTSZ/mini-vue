## 0-1-5-è™šæ‹ŸèŠ‚ç‚¹ vnode

åœ¨å‰é¢å°èŠ‚ä¸­æˆ‘ä»¬æå‡ºè¿‡ä¸€ä¸ªéœ€è¦ä¼˜åŒ–çš„ç‚¹ï¼š

> æ›´æ–°æ˜¯å…¨é‡çš„ï¼Œè€Œä¸æ˜¯å“ªé‡Œæ”¹å˜æ›´æ–°å“ªé‡Œï¼Œéœ€è¦ä¼˜åŒ–

### ä¼˜åŒ–æ€è·¯

å…¶å®ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦å¯¹æ¯”å‡ºæ¥å“ªäº›èŠ‚ç‚¹çš„å€¼å˜æ›´äº†ï¼Œåªæ›´æ–°è¿™äº›å˜æ›´çš„å³å¯

![](001.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ`nihao` èŠ‚ç‚¹æ²¡æœ‰å˜æ›´ï¼Œè€Œå¦ä¸€ä¸ªèŠ‚ç‚¹ä» `1` å˜æ›´åˆ° `10`ï¼Œæˆ‘ä»¬åªéœ€è¦æ›´æ–°è¿™ä¸ªèŠ‚ç‚¹å³å¯

### å¦‚ä½•æ¯”è¾ƒ

æˆ‘ä»¬å¯ä»¥é€šè¿‡ `Dom` æ¥æ¯”è¾ƒï¼Œæ¯”å¦‚è·å–å…¶ `children` åŠå±æ€§æ¥æ¯”è¾ƒæ˜¯å¦å˜æ›´ï¼Œä½†è®¿é—® `Dom` å¯¹è±¡ä¸Šçš„ `get` å’Œ `set` æ–¹æ³•æ—¶ï¼Œä¼šå½±å“æµè§ˆå™¨çš„æ¸²æŸ“ï¼Œä½¿å…¶å˜æ…¢

é‚£è¿˜æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥æ¯”è¾ƒå‘¢ï¼Ÿ

æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ™®é€šå¯¹è±¡æ¥è¡¨ç¤ºä¸€ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€

ä»¥ä¸‹é¢ä¸ºä¾‹ï¼š

```js
const element = document.createElement('div')
element.setAttribute('id', 'test')
element.append(document.createTextNode('nihao'))
```

æˆ‘ä»¬å¯ä»¥çŸ¥é“ `div` æ˜¯ä¸€ä¸ªå…³é”®ç‚¹ï¼Œæ˜¯è¿™ä¸ªèŠ‚ç‚¹çš„ `tag` æ ‡ç­¾

ç„¶å `id: test` ä¹Ÿæ˜¯ä¸€ä¸ªå…³é”®ç‚¹ï¼Œæ˜¯è¿™ä¸ªèŠ‚ç‚¹çš„å±æ€§ï¼Œè€Œä¸”å¯èƒ½æœ‰å¤šä¸ª

ç„¶å `nihao` ä¹Ÿæ˜¯ä¸€ä¸ªå…³é”®ç‚¹ï¼Œæ˜¯è¿™ä¸ªèŠ‚ç‚¹çš„ `children`ï¼Œè€Œä¸”å¯èƒ½æœ‰å¤šä¸ª

é‚£æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼Œä¸Šæ–¹çš„åˆ›å»º `element` çš„ä»£ç å°±å¯ä»¥ç”¨ä¸‹æ–¹çš„å¯¹è±¡æ¥è¡¨ç¤ºï¼š

```js
{
  tag: 'div',
  props: {
    id: 'test'
  },
  children: 'nihao'
}
```

è‡³æ­¤æˆ‘ä»¬å°±å®Œæˆäº†ç”¨ä¸€ä¸ªå¯¹è±¡æ¥è¡¨ç¤ºä¸€ä¸ªèŠ‚ç‚¹äº†

### å®ç°ç®€æ˜“ç‰ˆ h

åŸºäºä¸Šæ–¹çš„é€»è¾‘å°±å¯ä»¥å®Œæˆç®€æ˜“ç‰ˆçš„ `h` æ–¹æ³•ï¼š

```js
export function h(tag, props, children) {
  return { tag, props, children }
}
```

ç„¶ååœ¨ `render` ä¸­ä½¿ç”¨ `h` æ›¿ä»£ä»¥å‰çš„ `Dom` æ“ä½œ

```js
render(context) {
  // const element = document.createElement('div')
  // const nameText = document.createTextNode(`å§“åï¼š${context.user.name} \r`)
  // const ageText = document.createTextNode(`å¹´é¾„ï¼š${context.user.age}`)
  // element.appendChild(nameText)
  // element.appendChild(ageText)
  // return element
  return h('div', {}, [
    h('span', {}, `å§“åï¼š${context.user.name} \r`),
    h('span', {}, `å¹´é¾„ï¼š${context.user.age}`)
  ])
}
```

åœ¨ `createApp` ä¸­è¾“å‡ºéªŒè¯ä¸€ä¸‹ï¼š

```js
effectWatch(() => {
  rootContainer.textContent = ''
  const subTree = rootComponent.render(setupResult)
  console.log('ğŸš€ ~ file: createApp.js ~ line 11 ~ effectWatch ~ subTree', subTree)
  // ç”±äº subTree ä¸æ˜¯çœŸå®çš„ Domï¼Œæ— æ³•æ·»åŠ ï¼Œå…ˆæ³¨é‡Šæ‰
  // rootContainer.appendChild(element)
})
```

![](002.png)

å¯ä»¥çœ‹åˆ°é¦–æ¬¡è¾“å‡ºå’Œè‡ªé€‚åº”å‡æ²¡æœ‰é—®é¢˜

è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†å¯¹åº”çš„è™šæ‹ŸèŠ‚ç‚¹ï¼Œä»¥åŠè™šæ‹ŸèŠ‚ç‚¹è¡¨ç°å‡ºæ¥çš„å°±æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œåªä¸è¿‡æ˜¯ä¸€ç§æ ‘ç»“æ„ï¼Œé€šè¿‡ `children` ä¸€å±‚ä¸€å±‚é“¾æ¥èµ·æ¥çš„

é‚£æˆ‘ä»¬ä¸‹ä¸€æ­¥å°±æ˜¯å°†å…¶è½¬æ¢ä¸ºçœŸå® `Dom`ï¼Œç„¶åæ·»åŠ åˆ°è§†å›¾ä¸­
